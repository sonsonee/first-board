<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head th:replace="fragments/common :: html-head">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  </head>
  <style>
    .detailInfo{
        color: gray;
        font-size: small;
    }
    .comment{
        margin-top: 30px;
    }
    .commentNickname{
        font-size: medium;
    }
  </style>
  <body>
    <div th:replace="fragments/header :: header"></div>

    <div class="container">
      <!--post-->
      <div th:object="${post}">
        <!--title-->
        <h1 class="mt-5" th:text="*{title}">제목</h1>
        <small th:text="|작성자 : *{nickname}|" class="detailInfo">작성자</small><br>
        <small th:text="|작성일 : ${#temporals.format(post.createdDate, 'yyyy-mm-dd HH:mm')}|" class="detailInfo">작성일</small><br>
        <small th:text="|수정일 : ${#temporals.format(post.createdDate, 'yyyy-mm-dd HH:mm')}|" class="detailInfo">수정일</small>



        <!--content-->
        <div style="margin-top: 20px;">
          <pre style='white-space:pre-wrap; word-break: break-all;'
               th:utext="*{content}">내용</pre>
        </div>

        <!-- 작성자에게만 삭제/수정버튼 표시-->
        <div style="text-align: center; margin: 100px;">
          <button type="button" class="btn btn-primary"
                  onclick="location.href='home.html'"
                  th:onclick="|location.href='@{/}'|">목록</button>
          <button type="button" class="btn btn-primary"
                  th:if="${post.getMemberId().equals(memberId)}"
                  th:onclick="|location.href='@{/posts/edit/{postId}(postId=${post.id})}'|"
          >수정</button>
          <button hidden>
          <form action="#" th:action="@{'/posts/delete/{id}'(id=${post.id})}" th:method="delete" >
            <input type="hidden" name="_method" value="delete" />
            <button type="submit" class="btn btn-primary" id="submitButton"
                    th:if="${post.getMemberId().equals(memberId)}">삭제</button>
          </form>
          </button>

        </div>
      </div>

      <div th:unless="${post.getComments().isEmpty()}"><hr></div>

      <!--comments-->
      <div class="comment" th:each="comment : ${comments}">
        <div>
          <h6 class="commentNickname" th:text="${comment.nickname}">닉네임</h6>
          <small th:text="|작성일 : ${#temporals.format(comment.createdDate, 'yyyy-mm-dd HH:mm')}|" class="detailInfo">작성일</small>
        </div>
        <div>
          <pre style='white-space:pre-wrap; word_wrap:break-word; word-break: break-all;'
                   th:utext="${comment.content}">내용</pre>
        </div>
      </div>

      <hr>

      <!-- comment input -->
      <form role="form"
            action="/comments/write"
            th:action th:object="${addComment}" method="post"
            >
        <div class="mb-3">
          <label for="content" class="form-label">댓글 작성</label>
          <textarea class="form-control" id="content" placeholder="댓글을 입력하세요." rows="3"
                    th:field="*{content}" th:errorclass="field-error"></textarea>
          <div class="field-error" th:errors="*{content}">
            글 오류
          </div>
        </div>
        <div style="text-align: right; margin-bottom: 100px">
          <button
                  type="submit"
                  class="btn btn-primary"
          >
            등록
          </button>
        </div>
      </form>

    </div>


    </div>
  </body>
</html>
